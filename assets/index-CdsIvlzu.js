import{g as H,R as Q,r as C,u as $,a as Y,j as _,z as A}from"./index-dEIVpO1z.js";import{_ as X,a as J,b as G,c as K,d as Z,e as tt,g as O,B as F,o as et}from"./utils-Dkz-zxw0.js";import{P as nt,o as rt}from"./index-D3zXdg_m.js";const it="_tips_ol3jo_1",ot="_wrapper_ol3jo_7",at="_box_ol3jo_14",R={tips:it,wrapper:ot,box:at};var N={exports:{}},L,U;function st(){if(U)return L;U=1;var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return L=e,L}var z,B;function ct(){if(B)return z;B=1;var e=st();function r(){}function n(){}return n.resetWarningCache=r,z=function(){function t(c,o,h,a,l,d){if(d!==e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function i(){return t}var s={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:i,element:t,elementType:t,instanceOf:i,node:t,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:r};return s.PropTypes=s,s},z}var I;function ht(){return I||(I=1,N.exports=ct()()),N.exports}var ut=ht();const P=H(ut);/*!
 * Signature Pad v2.3.2
 * https://github.com/szimek/signature_pad
 *
 * Copyright 2017 Szymon Nowak
 * Released under the MIT license
 *
 * The main idea and some parts of the code (e.g. drawing variable width Bézier curve) are taken from:
 * http://corner.squareup.com/2012/07/smoother-signatures.html
 *
 * Implementation of interpolation using cubic Bézier curves is taken from:
 * http://benknowscode.wordpress.com/2012/09/14/path-interpolation-using-cubic-bezier-and-control-point-estimation-in-javascript
 *
 * Algorithm for approximated length of a Bézier curve is taken from:
 * http://www.lemoda.net/maths/bezier-length/index.html
 *
 */function S(e,r,n){this.x=e,this.y=r,this.time=n||new Date().getTime()}S.prototype.velocityFrom=function(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):1};S.prototype.distanceTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))};S.prototype.equals=function(e){return this.x===e.x&&this.y===e.y&&this.time===e.time};function j(e,r,n,t){this.startPoint=e,this.control1=r,this.control2=n,this.endPoint=t}j.prototype.length=function(){for(var e=10,r=0,n=void 0,t=void 0,i=0;i<=e;i+=1){var s=i/e,c=this._point(s,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),o=this._point(s,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(i>0){var h=c-n,a=o-t;r+=Math.sqrt(h*h+a*a)}n=c,t=o}return r};j.prototype._point=function(e,r,n,t,i){return r*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*t*(1-e)*e*e+i*e*e*e};function lt(e,r,n){var t,i,s,c=null,o=0;n||(n={});var h=function(){o=n.leading===!1?0:Date.now(),c=null,s=e.apply(t,i),c||(t=i=null)};return function(){var a=Date.now();!o&&n.leading===!1&&(o=a);var l=r-(a-o);return t=this,i=arguments,l<=0||l>r?(c&&(clearTimeout(c),c=null),o=a,s=e.apply(t,i),c||(t=i=null)):!c&&n.trailing!==!1&&(c=setTimeout(h,l)),s}}function p(e,r){var n=this,t=r||{};this.velocityFilterWeight=t.velocityFilterWeight||.7,this.minWidth=t.minWidth||.5,this.maxWidth=t.maxWidth||2.5,this.throttle="throttle"in t?t.throttle:16,this.minDistance="minDistance"in t?t.minDistance:5,this.throttle?this._strokeMoveUpdate=lt(p.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=p.prototype._strokeUpdate,this.dotSize=t.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=t.penColor||"black",this.backgroundColor=t.backgroundColor||"rgba(0,0,0,0)",this.onBegin=t.onBegin,this.onEnd=t.onEnd,this._canvas=e,this._ctx=e.getContext("2d"),this.clear(),this._handleMouseDown=function(i){i.which===1&&(n._mouseButtonDown=!0,n._strokeBegin(i))},this._handleMouseMove=function(i){n._mouseButtonDown&&n._strokeMoveUpdate(i)},this._handleMouseUp=function(i){i.which===1&&n._mouseButtonDown&&(n._mouseButtonDown=!1,n._strokeEnd(i))},this._handleTouchStart=function(i){if(i.targetTouches.length===1){var s=i.changedTouches[0];n._strokeBegin(s)}},this._handleTouchMove=function(i){i.preventDefault();var s=i.targetTouches[0];n._strokeMoveUpdate(s)},this._handleTouchEnd=function(i){var s=i.target===n._canvas;s&&(i.preventDefault(),n._strokeEnd(i))},this.on()}p.prototype.clear=function(){var e=this._ctx,r=this._canvas;e.fillStyle=this.backgroundColor,e.clearRect(0,0,r.width,r.height),e.fillRect(0,0,r.width,r.height),this._data=[],this._reset(),this._isEmpty=!0};p.prototype.fromDataURL=function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new Image,i=n.ratio||window.devicePixelRatio||1,s=n.width||this._canvas.width/i,c=n.height||this._canvas.height/i;this._reset(),t.src=e,t.onload=function(){r._ctx.drawImage(t,0,0,s,c)},this._isEmpty=!1};p.prototype.toDataURL=function(e){var r;switch(e){case"image/svg+xml":return this._toSVG();default:for(var n=arguments.length,t=Array(n>1?n-1:0),i=1;i<n;i++)t[i-1]=arguments[i];return(r=this._canvas).toDataURL.apply(r,[e].concat(t))}};p.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};p.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};p.prototype.isEmpty=function(){return this._isEmpty};p.prototype._strokeBegin=function(e){this._data.push([]),this._reset(),this._strokeUpdate(e),typeof this.onBegin=="function"&&this.onBegin(e)};p.prototype._strokeUpdate=function(e){var r=e.clientX,n=e.clientY,t=this._createPoint(r,n),i=this._data[this._data.length-1],s=i&&i[i.length-1],c=s&&t.distanceTo(s)<this.minDistance;if(!(s&&c)){var o=this._addPoint(t),h=o.curve,a=o.widths;h&&a&&this._drawCurve(h,a.start,a.end),this._data[this._data.length-1].push({x:t.x,y:t.y,time:t.time,color:this.penColor})}};p.prototype._strokeEnd=function(e){var r=this.points.length>2,n=this.points[0];if(!r&&n&&this._drawDot(n),n){var t=this._data[this._data.length-1],i=t[t.length-1];n.equals(i)||t.push({x:n.x,y:n.y,time:n.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(e)};p.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};p.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};p.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};p.prototype._createPoint=function(e,r,n){var t=this._canvas.getBoundingClientRect();return new S(e-t.left,r-t.top,n||new Date().getTime())};p.prototype._addPoint=function(e){var r=this.points,n=void 0;if(r.push(e),r.length>2){r.length===3&&r.unshift(r[0]),n=this._calculateCurveControlPoints(r[0],r[1],r[2]);var t=n.c2;n=this._calculateCurveControlPoints(r[1],r[2],r[3]);var i=n.c1,s=new j(r[1],t,i,r[2]),c=this._calculateCurveWidths(s);return r.shift(),{curve:s,widths:c}}return{}};p.prototype._calculateCurveControlPoints=function(e,r,n){var t=e.x-r.x,i=e.y-r.y,s=r.x-n.x,c=r.y-n.y,o={x:(e.x+r.x)/2,y:(e.y+r.y)/2},h={x:(r.x+n.x)/2,y:(r.y+n.y)/2},a=Math.sqrt(t*t+i*i),l=Math.sqrt(s*s+c*c),d=o.x-h.x,u=o.y-h.y,v=l/(a+l),m={x:h.x+d*v,y:h.y+u*v},f=r.x-m.x,x=r.y-m.y;return{c1:new S(o.x+f,o.y+x),c2:new S(h.x+f,h.y+x)}};p.prototype._calculateCurveWidths=function(e){var r=e.startPoint,n=e.endPoint,t={start:null,end:null},i=this.velocityFilterWeight*n.velocityFrom(r)+(1-this.velocityFilterWeight)*this._lastVelocity,s=this._strokeWidth(i);return t.start=this._lastWidth,t.end=s,this._lastVelocity=i,this._lastWidth=s,t};p.prototype._strokeWidth=function(e){return Math.max(this.maxWidth/(e+1),this.minWidth)};p.prototype._drawPoint=function(e,r,n){var t=this._ctx;t.moveTo(e,r),t.arc(e,r,n,0,2*Math.PI,!1),this._isEmpty=!1};p.prototype._drawCurve=function(e,r,n){var t=this._ctx,i=n-r,s=Math.floor(e.length());t.beginPath();for(var c=0;c<s;c+=1){var o=c/s,h=o*o,a=h*o,l=1-o,d=l*l,u=d*l,v=u*e.startPoint.x;v+=3*d*o*e.control1.x,v+=3*l*h*e.control2.x,v+=a*e.endPoint.x;var m=u*e.startPoint.y;m+=3*d*o*e.control1.y,m+=3*l*h*e.control2.y,m+=a*e.endPoint.y;var f=r+a*i;this._drawPoint(v,m,f)}t.closePath(),t.fill()};p.prototype._drawDot=function(e){var r=this._ctx,n=typeof this.dotSize=="function"?this.dotSize():this.dotSize;r.beginPath(),this._drawPoint(e.x,e.y,n),r.closePath(),r.fill()};p.prototype._fromData=function(e,r,n){for(var t=0;t<e.length;t+=1){var i=e[t];if(i.length>1)for(var s=0;s<i.length;s+=1){var c=i[s],o=new S(c.x,c.y,c.time),h=c.color;if(s===0)this.penColor=h,this._reset(),this._addPoint(o);else if(s!==i.length-1){var a=this._addPoint(o),l=a.curve,d=a.widths;l&&d&&r(l,d,h)}}else{this._reset();var u=i[0];n(u)}}};p.prototype._toSVG=function(){var e=this,r=this._data,n=this._canvas,t=Math.max(window.devicePixelRatio||1,1),i=0,s=0,c=n.width/t,o=n.height/t,h=document.createElementNS("http://www.w3.org/2000/svg","svg");h.setAttributeNS(null,"width",n.width),h.setAttributeNS(null,"height",n.height),this._fromData(r,function(g,y,b){var T=document.createElement("path");if(!isNaN(g.control1.x)&&!isNaN(g.control1.y)&&!isNaN(g.control2.x)&&!isNaN(g.control2.y)){var W="M "+g.startPoint.x.toFixed(3)+","+g.startPoint.y.toFixed(3)+" "+("C "+g.control1.x.toFixed(3)+","+g.control1.y.toFixed(3)+" ")+(g.control2.x.toFixed(3)+","+g.control2.y.toFixed(3)+" ")+(g.endPoint.x.toFixed(3)+","+g.endPoint.y.toFixed(3));T.setAttribute("d",W),T.setAttribute("stroke-width",(y.end*2.25).toFixed(3)),T.setAttribute("stroke",b),T.setAttribute("fill","none"),T.setAttribute("stroke-linecap","round"),h.appendChild(T)}},function(g){var y=document.createElement("circle"),b=typeof e.dotSize=="function"?e.dotSize():e.dotSize;y.setAttribute("r",b),y.setAttribute("cx",g.x),y.setAttribute("cy",g.y),y.setAttribute("fill",g.color),h.appendChild(y)});var a="data:image/svg+xml;base64,",l='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+i+" "+s+" "+c+" "+o+'"')+(' width="'+c+'"')+(' height="'+o+'"')+">",d=h.innerHTML;if(d===void 0){var u=document.createElement("dummy"),v=h.childNodes;u.innerHTML="";for(var m=0;m<v.length;m+=1)u.appendChild(v[m].cloneNode(!0));d=u.innerHTML}var f="</svg>",x=l+d+f;return a+btoa(x)};p.prototype.fromData=function(e){var r=this;this.clear(),this._fromData(e,function(n,t){return r._drawCurve(n,t.start,t.end)},function(n){return r._drawDot(n)}),this._data=e};p.prototype.toData=function(){return this._data};var M={exports:{}},dt=M.exports,q;function pt(){return q||(q=1,(function(e,r){(function(n,t){e.exports=t()})(dt,function(){return(function(n){function t(s){if(i[s])return i[s].exports;var c=i[s]={exports:{},id:s,loaded:!1};return n[s].call(c.exports,c,c.exports,t),c.loaded=!0,c.exports}var i={};return t.m=n,t.c=i,t.p="",t(0)})([function(n,t){function i(a){var l=a.getContext("2d"),d=a.width,u=a.height,v=l.getImageData(0,0,d,u).data,m=o(!0,d,u,v),f=o(!1,d,u,v),x=h(!0,d,u,v),g=h(!1,d,u,v),y=g-x+1,b=f-m+1,T=l.getImageData(x,m,y,b);return a.width=y,a.height=b,l.clearRect(0,0,y,b),l.putImageData(T,0,0),a}function s(a,l,d,u){return{red:u[4*(d*l+a)],green:u[4*(d*l+a)+1],blue:u[4*(d*l+a)+2],alpha:u[4*(d*l+a)+3]}}function c(a,l,d,u){return s(a,l,d,u).alpha}function o(a,l,d,u){for(var v=a?1:-1,m=a?0:d-1,f=m;a?f<d:f>-1;f+=v)for(var x=0;x<l;x++)if(c(x,f,l,u))return f;return null}function h(a,l,d,u){for(var v=a?1:-1,m=a?0:l-1,f=m;a?f<l:f>-1;f+=v)for(var x=0;x<d;x++)if(c(f,x,l,u))return f;return null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i}])})})(M)),M.exports}var vt=pt();const ft=H(vt);var mt=["canvasProps","clearOnResize"],k=(function(e){X(n,e);var r=J(n);function n(){var t;K(this,n);for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return t=r.call.apply(r,[this].concat(s)),t.staticThis=t.constructor,t._sigPad=null,t._canvas=null,t.setRef=function(o){t._canvas=o,t._canvas===null&&(t._sigPad=null)},t._excludeOurProps=function(){var o=t.props;o.canvasProps,o.clearOnResize;var h=Z(o,mt);return h},t.componentDidMount=function(){var o=t.getCanvas();t._sigPad=new p(o,t._excludeOurProps()),t._resizeCanvas(),t.on()},t.componentWillUnmount=function(){t.off()},t.componentDidUpdate=function(){Object.assign(t._sigPad,t._excludeOurProps())},t.getCanvas=function(){if(t._canvas===null)throw t.staticThis.refNullError;return t._canvas},t.getTrimmedCanvas=function(){var o=t.getCanvas(),h=document.createElement("canvas");return h.width=o.width,h.height=o.height,h.getContext("2d").drawImage(o,0,0),ft(h)},t.getSignaturePad=function(){if(t._sigPad===null)throw t.staticThis.refNullError;return t._sigPad},t._checkClearOnResize=function(){t.props.clearOnResize&&t._resizeCanvas()},t._resizeCanvas=function(){var o,h,a=(o=t.props.canvasProps)!==null&&o!==void 0?o:{},l=a.width,d=a.height;if(!(typeof l<"u"&&typeof d<"u")){var u=t.getCanvas(),v=Math.max((h=window.devicePixelRatio)!==null&&h!==void 0?h:1,1);typeof l>"u"&&(u.width=u.offsetWidth*v),typeof d>"u"&&(u.height=u.offsetHeight*v),u.getContext("2d").scale(v,v),t.clear()}},t.render=function(){var o=t.props.canvasProps;return Q.createElement("canvas",tt({ref:t.setRef},o))},t.on=function(){return window.addEventListener("resize",t._checkClearOnResize),t.getSignaturePad().on()},t.off=function(){return window.removeEventListener("resize",t._checkClearOnResize),t.getSignaturePad().off()},t.clear=function(){return t.getSignaturePad().clear()},t.isEmpty=function(){return t.getSignaturePad().isEmpty()},t.fromDataURL=function(o,h){return t.getSignaturePad().fromDataURL(o,h)},t.toDataURL=function(o,h){return t.getSignaturePad().toDataURL(o,h)},t.fromData=function(o){return t.getSignaturePad().fromData(o)},t.toData=function(){return t.getSignaturePad().toData()},t}return G(n)})(C.Component);k.propTypes={velocityFilterWeight:P.number,minWidth:P.number,maxWidth:P.number,minDistance:P.number,dotSize:P.oneOfType([P.number,P.func]),penColor:P.string,throttle:P.number,onEnd:P.func,onBegin:P.func,canvasProps:P.object,clearOnResize:P.bool};k.defaultProps={clearOnResize:!0};k.refNullError=new Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");function yt(e){const[r]=$(),n=r.get("num1")||"1",t=r.get("num2")||"1",i=r.get("operateType")||"+",s=r.get("total")||"15",[c,o]=C.useState(0),h=Y(),[a,l]=C.useState(0);C.useEffect(()=>{const w=setInterval(()=>{o(E=>E+1)},1e3);return()=>{clearTimeout(w)}},[]);const{current:d}=C.useRef(Array.from({length:Number(s)},()=>{const w=O(Number(n)),E=O(Number(t));let D;switch(i){case"mul":D=w*E;break;case"div":D=Number(Array.prototype.filter.call(String(w/E),V=>V!==".").slice(0,3).join(""));break;case"add":D=w+E;break;case"sub":D=w-E;break}return{num1:w,num2:E,operateType:i,answer:D}})),u=C.useRef(null),v=_.jsxs("b",{children:[n,"位数",et[i],t,"位数,共",s,"道"]}),m=d[a],[f,x]=C.useState(!1),g=C.useRef({width:window.innerWidth,height:window.innerHeight}),y=w=>{w.preventDefault(),m.userAnswer=u.current.value,b(),a+1>=d.length?h({pathname:"/result",search:"?completedList="+encodeURIComponent(JSON.stringify(d))+"&totalTime="+c}):(l(a+1),u.current.value="")},b=()=>{const w=u.current.value;m.answer==w?A.success("回答正确",{duration:1500,removeDelay:300}):A.error("回答错误",{duration:1500,removeDelay:300})},T=()=>{l(a-1),u.current.value=d[a-1].userAnswer,u.current?.focus?.()},W=()=>{if(m.userAnswer=u.current.value,b(),a===d.length-1){h({pathname:"/result",search:"?completedList="+encodeURIComponent(JSON.stringify(d))+"&totalTime="+c});return}l(a+1),u.current.value=d[a+1].userAnswer,u.current?.focus?.()};return _.jsxs(nt,{title:"练习",children:[_.jsx("h1",{style:{textAlign:"center"},children:v}),_.jsxs("p",{className:R.tips,children:["当前用时：",c,"秒"]}),_.jsxs("p",{className:R.tips,children:["当前题目：",a+1,"/",d.length]}),_.jsx("div",{className:R.wrapper,children:_.jsxs("div",{className:R.box,children:[_.jsx("div",{children:m.num1}),_.jsx("div",{children:rt[m.operateType]}),_.jsx("div",{children:m.num2}),_.jsx("div",{children:"="}),_.jsx("div",{children:_.jsx("form",{autoComplete:"off",style:{width:"100%",maxWidth:"140px"},onSubmit:y,children:_.jsx("input",{type:"number",step:"any",ref:u,name:"answer",style:{width:"100%",color:"#333",padding:"12px 0",border:"none",borderBottom:"2px solid #E0E0E0",borderRadius:"0",fontSize:"32px",fontWeight:"500",textAlign:"center",outline:"none",backgroundColor:"transparent",WebkitAppearance:"none",MozAppearance:"textfield",transition:"all 0.3s ease",caretColor:"#4A90E2"},autoFocus:!0,inputMode:"decimal",onInvalid:w=>{w.preventDefault()},placeholder:"?"})})}),_.jsxs("div",{style:{position:"fixed",padding:"0 4px 0",bottom:"0",left:"0",right:"0",display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"10px"},children:[_.jsx(F,{disabled:a===0,onClick:T,children:"上一题"}),_.jsx(F,{color:"primary",onClick:W,children:"下一题"})]}),_.jsxs("div",{style:{fontSize:16,position:"fixed",bottom:"60px",right:"6px",zIndex:1002,color:f?"#fff":"#000"},onClick:()=>{x(!f),f&&u.current.focus()},children:[f?"关闭":"打开","草稿"]}),f&&_.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",zIndex:1001,backgroundColor:"rgba(0,0,0,0.6)"},children:_.jsx(k,{penColor:"red",canvasProps:g.current})})]})})]})}export{yt as default};
